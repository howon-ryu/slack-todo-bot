name: Daily Reminder Check

on:
  schedule:
    # λ§¤μΌ ν•κµ­μ‹κ°„ μ¤μ „ 9μ‹ 30λ¶„ (UTC 00:30)
    - cron: '30 0 * * *'
  
  # μλ™ μ‹¤ν–‰λ„ κ°€λ¥ν•κ² μ„¤μ •
  workflow_dispatch:

jobs:
  send-reminders:
    runs-on: ubuntu-latest
    
    steps:
      - name: Check for overdue tasks
        run: |
          echo "π” λ§κ°μΌ μ§€λ‚ μ‘μ—…λ“¤μ„ ν™•μΈν•©λ‹λ‹¤..."
          
          # Vercel ν•¨μλ¥Ό νΈμ¶ν•΄μ„ λ¦¬λ§μΈλ” μ²΄ν¬ μ‹¤ν–‰
          response=$(curl -s -X POST \
            -H "Content-Type: application/json" \
            -d '{
              "type": "event_callback",
              "event": {
                "type": "app_mention",
                "text": "/check_reminders",
                "user": "SYSTEM_SCHEDULER",
                "channel": "SCHEDULER"
              }
            }' \
            https://slack-todo-bot.vercel.app/api/slack)
          
          echo "π“¤ μ‘λ‹µ: $response"
          echo "β… μλ™ λ¦¬λ§μΈλ” μ²΄ν¬ μ™„λ£!"
      
      - name: Log execution time
        run: |
          echo "β° μ‹¤ν–‰ μ‹κ°„: $(date '+%Y-%m-%d %H:%M:%S UTC')"
          echo "π‡°π‡· ν•κµ­ μ‹κ°„: $(TZ='Asia/Seoul' date '+%Y-%m-%d %H:%M:%S KST')"